# פרויקט: מערכת תחזית NQ – Daily Inside Weekly

## מטרת העל
לבנות מערכת מחקר ותחזית ל־NQ שמנסה להבין:
- איך הגרף "מתנהג" ברמות שונות (דקה, שעה, יום, שבוע)
- אילו דפוסים ידועים חוזרים על עצמם (FVG, OB, שינויים במבנה שוק וכו’)
- אילו דפוסים חדשים ולא מוכרים חוזרים על עצמם סטטיסטית
- איך זמן, סשנים ותקופות (ימים/שבועות/חודשים) משפיעים על התבניות
- איך כל זאת מתחבר לתחזית יומית בתוך מסגרת שבועית

---

## שלב 1 – Data Layer (שכבת נתונים)

### מטרות
- לבנות מקור אמת אחיד (Single Source of Truth) לנתוני NQ.
- לייצר טיימפריימים סטנדרטיים: 1m, 5m, 15m, 1H, 4H, Daily, Weekly.
- להעשיר כל נר במטא־דאטה: סשן, יום בשבוע, שבוע בחודש, חודש, תקופת מאקרו.

### משימות עיקריות
1. בחירת מקור נתונים (API / קובצי היסטוריה).
2. בניית מודול משיכה ושמירה (raw → parquet/csv).
3. יצירת Resample לכל טיימפריים.
4. הוספת שדות זמן:
   - session (Asia / London / NY)
   - day_of_week
   - week_of_month
   - month
5. שמירת שכבה מעובדת תחת `data/processed`.

---

## שלב 2 – Known Patterns Engine (דפוסים ידועים)

### מטרות
- לזהות ולתעד דפוסים קלאסיים על בסיס שכבת הנתונים:
  - FVG / IFVG
  - Order Blocks / Breaker Blocks
  - Market Structure (HH, HL, LH, LL, CHoCH, BOS)
  - Volume Profile אזוריים
  - סטיות מ־VWAP ורמות נגזרות

### משימות עיקריות
1. הגדרת מבנה אובייקטים לדפוסים (ID, סוג, טווח מחיר, טיימפריים, זמן, סטטוס).
2. בניית מודולים ב־`src/known_patterns` לכל דפוס.
3. יצירת טבלאות / קבצים נלווים עם כל הדפוסים לאורך ההיסטוריה.
4. בדיקת sanity: האם הדפוסים מתנהגים כמו שהיינו מצפים (מבחינת סטטיסטיקה בסיסית).

---

## שלב 3 – גילוי דפוסים חדשים (Unsupervised Pattern Discovery)

### מטרות
- לזהות "חתימות" תנועה חוזרות שלא מוגדרות מראש.
- לקבל קלאסטרים של התנהגות מחיר/ווליום/זמן ולהבין מה חוזר.

### משימות עיקריות
1. הגדרת חלון תנועה (segments) – לדוגמה:
   - תנועות של X נרות
   - מהלך בין צירים מסוימים (swing high/low)
2. בניית Feature Engineering:
   - שינויי מחיר יחסיים
   - טווחי נרות, תנודתיות, ווליום, מיקום ביחס ל־VWAP וכו’.
3. שימוש ב־Clustering (k-means / HDBSCAN/DBSCAN) כדי לפלח תבניות.
4. תיוג הקלאסטרים ושמירתם (ID, מאפיינים, סטטיסטיקות בסיסיות).

---

## שלב 4 – Temporal Behavior Engine (זמן וסטטיסטיקה)

### מטרות
- להבין מתי הדפוסים מופיעים:
  - שעות ביום
  - ימים בשבוע
  - שבועות בחודש
  - לפני/אחרי אירועי מאקרו
- לבנות "מפה" של דפוסים לאורך זמן.

### משימות עיקריות
1. הוספת מאפייני זמן לכל דפוס (ידוע וחדש).
2. יצירת טבלאות סטטיסטיות:
   - Frequency לפי יום/שעה
   - Win-rate משוער (אם יש הגדרה של כיוון/המשך/היפוך)
3. יצירת מנוע שמחזיר:
   - “מה הדפוסים המאפיינים את יום X בשבוע בתקופה Y”
   - “איזה קלאסטרים חוזרים בשעות מסוימות”

---

## שלב 5 – Forecast Engine (מנוע תחזית)

### מטרות
- להפיק תחזית ליום הקרוב בתוך מסגרת שבועית:
  - כיוון מועדף (Up / Down / Range)
  - אזורים "חמים" פוטנציאליים (Price Zones)
  - אזהרות (לא לסחור, תנודתיות חריגה, ימים חריגים סטטיסטית)

### משימות עיקריות
1. הגדרת קלט למנוע:
   - נתוני השבוע הנוכחי עד עכשיו.
   - הדפוסים שהתגלו.
   - סטטיסטיקות מהשלב הטמפורלי.
2. הגדרת חוקים / מודל:
   - חוקים דטרמיניסטיים + אפשרות להרחבה למודל ML בעתיד.
3. הפקת Output בפורמט מובנה (JSON / טבלה):
   - תחזית כיוון
   - אזורי עניין
   - Confidence Score
4. שמירת התחזיות לצורך בדיקות היסטוריות.

---

## שלב 6 – Dashboard & Reports

### מטרות
- לתת לך תמונה ויזואלית וברורה לכל יום/שבוע:
  - מה היה, מה המערכת רואה, ומה התחזית.
- לאפשר ניתוח לאחור (Backtesting mental) על הרעיונות.

### משימות עיקריות
1. בחירת טכנולוגיה לדשבורד (Streamlit / Dash / FastAPI + Frontend).
2. בניית מסכי:
   - Overview יומי/שבועי
   - פירוק לפי דפוסים ידועים/חדשים
   - מפת זמן (Heatmaps)
3. הפקת דוחות:
   - דוח יומי (PDF/HTML)

   - דוח שבועי מסכם

---

## תיעדוף עבודה

בשלב ראשון:
1. שלב 1 – Data Layer (חובה לפני הכל)
2. שלב 2 – Known Patterns
3. שלב 4 – Temporal Behavior על דפוסים ידועים
4. רק אז – שלב 3 (דפוסים חדשים) ו־שלב 5 (Forecast Engine)
5. בסוף – שלב 6 (Dashboard & Reports)
